{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\FullStack\\\\fullStack1\\\\fullstack\\\\src\\\\views\\\\Movie.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport moviesUtils from '../utils/moviesUtils';\nimport subscriptionsUtils from '../utils/subscriptionsUtils';\nimport { useSelector } from \"react-redux\";\nimport { Link } from 'react-router-dom';\nimport memberUtils from '../utils/membersUtils';\nimport Card from '@mui/material/Card';\nimport CardActions from '@mui/material/CardActions';\nimport CardContent from '@mui/material/CardContent';\nimport Button from '@mui/material/Button';\nimport Typography from '@mui/material/Typography';\nimport Input from '@mui/material/Input';\nimport Box from '@mui/material/Box';\nimport Container from '@mui/material/Container';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MovieComp = props => {\n  _s();\n\n  const [movie, setMovie] = useState({});\n  const [members, setMemebers] = useState([]);\n  const [subscriptions, setSubscriptions] = useState([]);\n  const [editMovie, setEditMovie] = useState(false);\n  const [updatedMovie, setUpdatedMovie] = useState({});\n  const permissions = useSelector(state => state.user.Permissions);\n  useEffect(() => {\n    async function fetchData() {\n      let allMembers = await memberUtils.allMembers();\n      setMemebers(allMembers);\n      let id = props.movie ? props.movie._id : props.match.params.id;\n      let subscriptionsData = await subscriptionsUtils.getSubscriptionsByMovie(id);\n      setSubscriptions(subscriptionsData);\n    }\n\n    fetchData();\n  }, []);\n  useEffect(() => {\n    async function fetchData() {\n      if (props.movie) {\n        setMovie(props.movie);\n      } else {\n        let movie = await moviesUtils.getMovie(props.match.params.id);\n        setMovie(movie);\n      }\n\n      ;\n    }\n\n    fetchData();\n  }, [props]);\n\n  const deleteMovie = async () => {\n    let movieDeleted = await moviesUtils.deleteMovie(movie._id);\n    return movieDeleted;\n  };\n\n  const sendData = async () => {\n    await moviesUtils.EditMovie(movie._id, updatedMovie);\n    setEditMovie(!editMovie);\n  };\n\n  const getMemberName = id => {\n    let memberData = members.filter(x => x._id === id);\n    return memberData[0].Name;\n  };\n\n  return /*#__PURE__*/_jsxDEV(Card, {\n    children: /*#__PURE__*/_jsxDEV(CardContent, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: \"400px\",\n          borderWidth: \"3px\",\n          borderStyle: \"solid\",\n          borderColor: \"gray\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          gutterBottom: true,\n          variant: \"h6\",\n          component: \"div\",\n          children: [movie.Name, \",   \", movie.Premiered]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 11\n        }, this), \"Genres:  \", movie.Genres, \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 35\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 42\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          alt: movie.id,\n          width: \"140px\",\n          height: \"200px\",\n          src: movie.Image\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 80\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \" Subscriptions Watched : \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 13\n          }, this), subscriptions.length > 0 && /*#__PURE__*/_jsxDEV(\"ul\", {\n            children: subscriptions.map((item, index) => {\n              return /*#__PURE__*/_jsxDEV(\"li\", {\n                children: [/*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/member/\" + item.MemberId,\n                  children: getMemberName(item.MemberId)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 84,\n                  columnNumber: 21\n                }, this), \",\", item.Movies.date, \" \"]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 83,\n                columnNumber: 26\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CardActions, {\n          children: [permissions.includes(\"Update Movies\") && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              size: \"small\",\n              variant: \"outlined\",\n              onClick: e => setEditMovie(!editMovie),\n              children: \"Edit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 15\n          }, this), permissions.includes(\"Delete Movies\") && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              size: \"small\",\n              variant: \"outlined\",\n              color: \"error\",\n              onClick: deleteMovie,\n              children: \"Delete\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Container, {\n          children: editMovie && /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              bgcolor: '#cfe8fc'\n            },\n            children: [\"Name : \", /*#__PURE__*/_jsxDEV(Input, {\n              name: \"Name\",\n              defaultValue: movie.Name,\n              onChange: e => setUpdatedMovie({ ...updatedMovie,\n                Name: e.target.value\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 26\n            }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 149\n            }, this), \"Genres : \", /*#__PURE__*/_jsxDEV(Input, {\n              name: \" Genres\",\n              defaultValue: movie.Genres,\n              onChange: e => setUpdatedMovie({ ...updatedMovie,\n                Genres: e.target.value\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 28\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 157\n            }, this), \"Image URL : \", /*#__PURE__*/_jsxDEV(Input, {\n              name: \"Image\",\n              defaultValue: movie.Image,\n              onChange: e => setUpdatedMovie({ ...updatedMovie,\n                Image: e.target.value\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 31\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 156\n            }, this), \"Premiered : \", /*#__PURE__*/_jsxDEV(Input, {\n              type: \"date\",\n              name: \"Premiered\",\n              value: movie.Premiered,\n              onChange: e => setUpdatedMovie({ ...updatedMovie,\n                Premiered: e.target.value\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 31\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 173\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              size: \"small\",\n              color: \"success\",\n              variant: \"outlined\",\n              onClick: sendData,\n              children: \"Save\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 112,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"outlined\",\n              size: \"small\",\n              onClick: e => setEditMovie(!editMovie),\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n};\n\n_s(MovieComp, \"kW2T9or6rnY7cXiPT5pGI6KWA0g=\", false, function () {\n  return [useSelector];\n});\n\n_c = MovieComp;\nexport default MovieComp;\n\nvar _c;\n\n$RefreshReg$(_c, \"MovieComp\");","map":{"version":3,"sources":["C:/Users/User/FullStack/fullStack1/fullstack/src/views/Movie.js"],"names":["useState","useEffect","moviesUtils","subscriptionsUtils","useSelector","Link","memberUtils","Card","CardActions","CardContent","Button","Typography","Input","Box","Container","MovieComp","props","movie","setMovie","members","setMemebers","subscriptions","setSubscriptions","editMovie","setEditMovie","updatedMovie","setUpdatedMovie","permissions","state","user","Permissions","fetchData","allMembers","id","_id","match","params","subscriptionsData","getSubscriptionsByMovie","getMovie","deleteMovie","movieDeleted","sendData","EditMovie","getMemberName","memberData","filter","x","Name","width","borderWidth","borderStyle","borderColor","Premiered","Genres","Image","length","map","item","index","MemberId","Movies","date","includes","e","bgcolor","target","value"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\r\nimport moviesUtils from '../utils/moviesUtils'\r\nimport subscriptionsUtils from '../utils/subscriptionsUtils'\r\nimport { useSelector } from \"react-redux\";\r\nimport { Link } from 'react-router-dom';\r\nimport memberUtils from '../utils/membersUtils'\r\nimport Card from '@mui/material/Card';\r\nimport CardActions from '@mui/material/CardActions';\r\nimport CardContent from '@mui/material/CardContent';\r\nimport Button from '@mui/material/Button';\r\nimport Typography from '@mui/material/Typography';\r\nimport Input from '@mui/material/Input';\r\nimport Box from '@mui/material/Box';\r\nimport Container from '@mui/material/Container';\r\n\r\nconst MovieComp = (props) => {\r\n  const [movie, setMovie] = useState({})\r\n  const [members, setMemebers] = useState([])\r\n  const [subscriptions, setSubscriptions] = useState([])\r\n  const [editMovie, setEditMovie] = useState(false)\r\n  const [updatedMovie, setUpdatedMovie] = useState({})\r\n  const permissions = useSelector((state) => state.user.Permissions)\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      let allMembers = await memberUtils.allMembers();\r\n      setMemebers(allMembers);\r\n      let id = props.movie ? props.movie._id : props.match.params.id\r\n      let subscriptionsData = await subscriptionsUtils.getSubscriptionsByMovie(id);\r\n      setSubscriptions(subscriptionsData)\r\n    }\r\n    fetchData();\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      if (props.movie) {\r\n        setMovie(props.movie)\r\n      }\r\n      else {\r\n        let movie = await moviesUtils.getMovie(props.match.params.id);\r\n        setMovie(movie)\r\n      }\r\n      ;\r\n    }\r\n    fetchData();\r\n  }, [props])\r\n\r\n  const deleteMovie = async () => {\r\n    let movieDeleted = await moviesUtils.deleteMovie(movie._id);\r\n    return movieDeleted\r\n  }\r\n\r\n  const sendData = async () => {\r\n    await moviesUtils.EditMovie(movie._id, updatedMovie);\r\n    setEditMovie(!editMovie)\r\n    \r\n  }\r\n\r\n  const getMemberName = (id) => {\r\n    let memberData = members.filter(x => x._id === id);\r\n    return memberData[0].Name;\r\n  }\r\n\r\n\r\n  return (\r\n    <Card >\r\n\r\n      <CardContent>\r\n        <div style={{ width: \"400px\", borderWidth: \"3px\", borderStyle: \"solid\", borderColor: \"gray\" }}>\r\n          <Typography gutterBottom variant=\"h6\" component=\"div\">\r\n            {movie.Name},   {movie.Premiered}\r\n          </Typography>\r\n\r\n          Genres:  {movie.Genres} <br /> <br />\r\n          <img alt={movie.id} width=\"140px\" height=\"200px\" src={movie.Image} /><br />\r\n\r\n          <div>\r\n            <h4> Subscriptions Watched : </h4>\r\n            {subscriptions.length > 0 &&\r\n              <ul>\r\n                {subscriptions.map((item, index) => {\r\n                  return <li key={index}>\r\n                    <Link to={\"/member/\" + item.MemberId} >{getMemberName(item.MemberId)}</Link>,\r\n                    {item.Movies.date} </li>\r\n                })}\r\n              </ul>\r\n            }\r\n          </div>\r\n          <CardActions>\r\n            {permissions.includes(\"Update Movies\") &&\r\n              <div>\r\n                <Button size=\"small\" variant=\"outlined\" onClick={e => setEditMovie(!editMovie)}>Edit</Button>\r\n              </div>\r\n            }\r\n            {permissions.includes(\"Delete Movies\") &&\r\n              <div>\r\n                <Button  size=\"small\" variant=\"outlined\" color=\"error\" onClick={deleteMovie}>Delete</Button>\r\n              </div>\r\n            }\r\n          </CardActions>\r\n          <Container >\r\n            {editMovie &&\r\n            <Box sx={{ bgcolor: '#cfe8fc' }}>\r\n              \r\n                \r\n                  Name : <Input name=\"Name\" defaultValue={movie.Name} onChange={e => setUpdatedMovie({ ...updatedMovie, Name: e.target.value })} /> <br />\r\n                  Genres : <Input name=\" Genres\" defaultValue={movie.Genres} onChange={e => setUpdatedMovie({ ...updatedMovie, Genres: e.target.value })} /><br />\r\n                  Image URL : <Input name=\"Image\" defaultValue={movie.Image} onChange={e => setUpdatedMovie({ ...updatedMovie, Image: e.target.value })} /><br />\r\n                  Premiered : <Input type=\"date\" name=\"Premiered\" value={movie.Premiered} onChange={e => setUpdatedMovie({ ...updatedMovie, Premiered: e.target.value })} /><br />\r\n                 \r\n                  <Button size=\"small\" color=\"success\" variant=\"outlined\" onClick={sendData}>Save</Button>              \r\n                  <Button variant=\"outlined\" size=\"small\" onClick={e => setEditMovie(!editMovie)}>Cancel</Button>\r\n\r\n              </Box>\r\n            }\r\n         </Container>\r\n        </div>\r\n      </CardContent>\r\n    </Card>)\r\n}\r\n\r\n\r\n\r\nexport default MovieComp;"]},"metadata":{},"sourceType":"module"}